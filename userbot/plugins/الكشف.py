import base64
exec(base64.b64decode(b'aW1wb3J0IGh0bWwKaW1wb3J0IG9zCgpmcm9tIHJlcXVlc3RzIGltcG9ydCBnZXQKZnJvbSB0ZWxldGhvbi50bC5mdW5jdGlvbnMucGhvdG9zIGltcG9ydCBHZXRVc2VyUGhvdG9zUmVxdWVzdApmcm9tIHRlbGV0aG9uLnRsLmZ1bmN0aW9ucy51c2VycyBpbXBvcnQgR2V0RnVsbFVzZXJSZXF1ZXN0CmZyb20gdGVsZXRob24udXRpbHMgaW1wb3J0IGdldF9pbnB1dF9sb2NhdGlvbgoKZnJvbSB1c2VyYm90IGltcG9ydCBqbXRob24KZnJvbSB1c2VyYm90LmNvcmUubG9nZ2VyIGltcG9ydCBsb2dnaW5nCgpmcm9tIC4uQ29uZmlnIGltcG9ydCBDb25maWcKZnJvbSAuLmNvcmUubWFuYWdlcnMgaW1wb3J0IGVkaXRfb3JfcmVwbHkKZnJvbSAuLmhlbHBlcnMgaW1wb3J0IGdldF91c2VyX2Zyb21fZXZlbnQsIHJlcGx5X2lkCmZyb20gLiBpbXBvcnQgc3BhbXdhdGNoCgpwbHVnaW5fY2F0ZWdvcnkgPSAidXRpbHMiCkxPR1MgPSBsb2dnaW5nLmdldExvZ2dlcihfX25hbWVfXykKCgphc3luYyBkZWYgZmV0Y2hfaW5mbyhyZXBsaWVkX3VzZXIsIGV2ZW50KToKICAgICIiIkdldCBkZXRhaWxzIGZyb20gdGhlIFVzZXIgb2JqZWN0LiIiIgogICAgcmVwbGllZF91c2VyX3Byb2ZpbGVfcGhvdG9zID0gYXdhaXQgZXZlbnQuY2xpZW50KAogICAgICAgIEdldFVzZXJQaG90b3NSZXF1ZXN0KAogICAgICAgICAgICB1c2VyX2lkPXJlcGxpZWRfdXNlci51c2VyLmlkLCBvZmZzZXQ9NDIsIG1heF9pZD0wLCBsaW1pdD04MAogICAgICAgICkKICAgICkKICAgIHJlcGxpZWRfdXNlcl9wcm9maWxlX3Bob3Rvc19jb3VudCA9ICLijK/vuJnZh9iw2Kcg2KfZhNmF2LPYqtiu2K/ZhSDZhNmFINmK2LbYuSDYp9mKINi12YjYsdipIgogICAgdHJ5OgogICAgICAgIHJlcGxpZWRfdXNlcl9wcm9maWxlX3Bob3Rvc19jb3VudCA9IHJlcGxpZWRfdXNlcl9wcm9maWxlX3Bob3Rvcy5jb3VudAogICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgIHBhc3MKICAgIHVzZXJfaWQgPSByZXBsaWVkX3VzZXIudXNlci5pZAogICAgZmlyc3RfbmFtZSA9IHJlcGxpZWRfdXNlci51c2VyLmZpcnN0X25hbWUKICAgIGxhc3RfbmFtZSA9IHJlcGxpZWRfdXNlci51c2VyLmxhc3RfbmFtZQogICAgdHJ5OgogICAgICAgIGRjX2lkLCBsb2NhdGlvbiA9IGdldF9pbnB1dF9sb2NhdGlvbihyZXBsaWVkX3VzZXIucHJvZmlsZV9waG90bykKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcGFzcwogICAgY29tbW9uX2NoYXQgPSByZXBsaWVkX3VzZXIuY29tbW9uX2NoYXRzX2NvdW50CiAgICB1c2VybmFtZSA9IHJlcGxpZWRfdXNlci51c2VyLnVzZXJuYW1lCiAgICB1c2VyX2JpbyA9IHJlcGxpZWRfdXNlci5hYm91dAogICAgcmVwbGllZF91c2VyLnVzZXIuYm90CiAgICByZXBsaWVkX3VzZXIudXNlci5yZXN0cmljdGVkCiAgICByZXBsaWVkX3VzZXIudXNlci52ZXJpZmllZAogICAgcGhvdG8gPSBhd2FpdCBldmVudC5jbGllbnQuZG93bmxvYWRfcHJvZmlsZV9waG90bygKICAgICAgICB1c2VyX2lkLAogICAgICAgIENvbmZpZy5UTVBfRE9XTkxPQURfRElSRUNUT1JZICsgc3RyKHVzZXJfaWQpICsgIi5qcGciLAogICAgICAgIGRvd25sb2FkX2JpZz1UcnVlLAogICAgKQogICAgZmlyc3RfbmFtZSA9ICgKICAgICAgICBmaXJzdF9uYW1lLnJlcGxhY2UoIlx1MjA2MCIsICIiKQogICAgICAgIGlmIGZpcnN0X25hbWUKICAgICAgICBlbHNlICgi4oyv77iZ2YfYsNinINin2YTZhdiz2KrYrtiv2YUg2YTZitizINmE2K/ZitmHINin2LPZhSDYp9mI2YQiKQogICAgKQogICAgbGFzdF9uYW1lID0gbGFzdF9uYW1lLnJlcGxhY2UoIlx1MjA2MCIsICIiKSBpZiBsYXN0X25hbWUgZWxzZSAoIiAiKQogICAgdXNlcm5hbWUgPSAiQHt9Ii5mb3JtYXQodXNlcm5hbWUpIGlmIHVzZXJuYW1lIGVsc2UgKCLijK/vuJnZh9mA2LDYpyDYp9mE2LTYrti1INmE2YrYsyDZhNiv2YrZgNmHINmF2LnZgNix2YEgIikKICAgIHVzZXJfYmlvID0gIuKZsO+4mdmH2LDYpyDYp9mE2YXYs9iq2K7Yr9mFINmE2YrYsyDZhNiv2YrZhyDYp9mKINmG2KjZgNiw2KkiIGlmIG5vdCB1c2VyX2JpbyBlbHNlIHVzZXJfYmlvCiAgICBjYXB0aW9uID0gIuKcm+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKcmyBcbiIKICAgIGNhcHRpb24gKz0gZiI8Yj4tIPCdmK/wnZii8J2YrvCdmKYg4pmwOjwvYj4ge2ZpcnN0X25hbWV9IHtsYXN0X25hbWV9XG4iCiAgICBjYXB0aW9uICs9IGYiPGI+LSDwnZiq8J2YpSDimbA6PC9iPiA8Y29kZT57dXNlcl9pZH08L2NvZGU+XG4iCiAgICBjYXB0aW9uICs9IGYiPGI+LSDwnZip8J2YovCdmK/wnZil8J2YtCDimbA6PC9iPiB7dXNlcm5hbWV9XG4iCiAgICBjYXB0aW9uICs9IGYiPGI+LSDwnZiv8J2YtvCdmK7wnZij8J2YpvCdmLMg8J2YsPCdmKcg8J2YqvCdmK7wnZii8J2YqPCdmKbwnZi0IOKZsDo8L2I+IHtyZXBsaWVkX3VzZXJfcHJvZmlsZV9waG90b3NfY291bnR9XG4iCiAgICBjYXB0aW9uICs9IGYiPGI+Le+4jyDwnZi08J2YsPCdmK3wnZilIOKZsDo8L2I+IDxjb2RlPnt1c2VyX2Jpb308L2NvZGU+XG4iCiAgICBjYXB0aW9uICs9IGYiPGI+LSDwnZi08J2YtvCdmKPwnZi08J2YpPCdmLPwnZiq8J2Yo/CdmKbwnZizIPCdmKjwnZiz8J2YsPCdmLbwnZix8J2YtCDimbA6PC9iPiB7Y29tbW9uX2NoYXR9XG4iCiAgICBjYXB0aW9uICs9IGYiPGI+LSDwnZik8J2YsPCdmK/wnZiv8J2YpvCdmKTwnZi18J2YsPCdmLMg4pmwOjwvYj4gIgogICAgY2FwdGlvbiArPSBmJzxhIGhyZWY9InRnOi8vdXNlcj9pZD17dXNlcl9pZH0iPntmaXJzdF9uYW1lfTwvYT5cbicKICAgIGNhcHRpb24gKz0gZiI8Yj4tIPCdmLTwnZiw8J2YtvCdmLPwnZik8J2YpiDwnZil8J2YpvCdmLDwnZi2IOKZsDo8L2I+IEBERU9PVVNcbiIKICAgIGNhcHRpb24gKz0gZiLinJvilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHinJsiCiAgICByZXR1cm4gcGhvdG8sIGNhcHRpb24KCgpAam10aG9uLmFyX2NtZCgKICAgIHBhdHRlcm49ItmD2LTZgSg/OlxzfCQpKFtcc1xTXSopIiwKICAgIGNvbW1hbmQ9KCLZg9i02YEiLCBwbHVnaW5fY2F0ZWdvcnkpLAogICAgaW5mbz17CiAgICAgICAgImhlYWRlciI6ICJHZXRzIGluZm9ybWF0aW9uIG9mIGFuIHVzZXIgc3VjaCBhcyByZXN0cmljdGlvbnMgYmFuIGJ5IHNwYW13YXRjaCBvciBjYXMuIiwKICAgICAgICAiZGVzY3JpcHRpb24iOiAiVGhhdCBpcyBsaWtlIHdoZXRoZXIgaGUgYmFubmVkIGlzIHNwYW13YXRjaCBvciBjYXMgYW5kIHNtYWxsIGluZm8gbGlrZSBncm91cHMgaW4gY29tbW9uLCBkYyAuLmV0Yy4iLAogICAgICAgICJ1c2FnZSI6ICJ7dHJ9dXNlcmluZm8gPHVzZXJuYW1lL3VzZXJpZC9yZXBseT4iLAogICAgfSwKKQphc3luYyBkZWYgXyhldmVudCk6CiAgICAiR2V0cyBpbmZvcm1hdGlvbiBvZiBhbiB1c2VyIHN1Y2ggYXMgcmVzdHJpY3Rpb25zIGJhbiBieSBzcGFtd2F0Y2ggb3IgY2FzIgogICAgcmVwbGllZF91c2VyLCBlcnJvcl9pX2EgPSBhd2FpdCBnZXRfdXNlcl9mcm9tX2V2ZW50KGV2ZW50KQogICAgaWYgbm90IHJlcGxpZWRfdXNlcjoKICAgICAgICByZXR1cm4KICAgIGNhdGV2ZW50ID0gYXdhaXQgZWRpdF9vcl9yZXBseShldmVudCwgIuKMr++4mdis2KfYsSDYpdit2LbYp9ixINmF2LnZhNmI2YXYp9iqINin2YTZhdiz2KrYrtiv2YUg2KfZhtmG2LjYsSDZgtmE2YrZhNinIOKaku+4jyIpCiAgICByZXBsaWVkX3VzZXIgPSBhd2FpdCBldmVudC5jbGllbnQoR2V0RnVsbFVzZXJSZXF1ZXN0KHJlcGxpZWRfdXNlci5pZCkpCiAgICB1c2VyX2lkID0gcmVwbGllZF91c2VyLnVzZXIuaWQKICAgICMgc29tZSBwZW9wbGUgaGF2ZSB3ZWlyZCBIVE1MIGluIHRoZWlyIG5hbWVzCiAgICBmaXJzdF9uYW1lID0gaHRtbC5lc2NhcGUocmVwbGllZF91c2VyLnVzZXIuZmlyc3RfbmFtZSkKICAgICMgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzUwNzIwMzEvNDcyMzk0MAogICAgIyBzb21lIERlbGV0ZWQgQWNjb3VudHMgZG8gbm90IGhhdmUgZmlyc3RfbmFtZQogICAgaWYgZmlyc3RfbmFtZSBpcyBub3QgTm9uZToKICAgICAgICAjIHNvbWUgd2VpcmQgcGVvcGxlIChsaWtlIG1lKSBoYXZlIG1vcmUgdGhhbiA0MDk2IGNoYXJhY3RlcnMgaW4gdGhlaXIKICAgICAgICAjIG5hbWVzCiAgICAgICAgZmlyc3RfbmFtZSA9IGZpcnN0X25hbWUucmVwbGFjZSgiXHUyMDYwIiwgIiIpCiAgICAjIGluc3BpcmVkIGJ5IGh0dHBzOi8vdGVsZWdyYW0uZG9nL2Fmc2FJMTgxCiAgICBjb21tb25fY2hhdHMgPSByZXBsaWVkX3VzZXIuY29tbW9uX2NoYXRzX2NvdW50CiAgICB0cnk6CiAgICAgICAgZGNfaWQsIGxvY2F0aW9uID0gZ2V0X2lucHV0X2xvY2F0aW9uKHJlcGxpZWRfdXNlci5wcm9maWxlX3Bob3RvKQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBkY19pZCA9ICJDb3VsZG4ndCBmZXRjaCBEQyBJRCEiCiAgICBpZiBzcGFtd2F0Y2g6CiAgICAgICAgYmFuID0gc3BhbXdhdGNoLmdldF9iYW4odXNlcl9pZCkKICAgICAgICBpZiBiYW46CiAgICAgICAgICAgIHN3ID0gZiIqKlNwYW13YXRjaCBCYW5uZWQgOioqIGBUcnVlYCBcbiAgICAgICAqKi0qKvCfpLfigI3imYLvuI8qKlJlYXNvbiA6ICoqYHtiYW4ucmVhc29ufWAiCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3cgPSBmIioqU3BhbXdhdGNoIEJhbm5lZCA6KiogYEZhbHNlYCIKICAgIGVsc2U6CiAgICAgICAgc3cgPSAiKipTcGFtd2F0Y2ggQmFubmVkIDoqKmBOb3QgQ29ubmVjdGVkYCIKICAgIHRyeToKICAgICAgICBjYXN1cmwgPSAiaHR0cHM6Ly9hcGkuY2FzLmNoYXQvY2hlY2s/dXNlcl9pZD17fSIuZm9ybWF0KHVzZXJfaWQpCiAgICAgICAgZGF0YSA9IGdldChjYXN1cmwpLmpzb24oKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIExPR1MuaW5mbyhlKQogICAgICAgIGRhdGEgPSBOb25lCiAgICBpZiBkYXRhOgogICAgICAgIGlmIGRhdGFbIm9rIl06CiAgICAgICAgICAgIGNhcyA9ICIqKkFudGlzcGFtKENBUykgQmFubmVkIDoqKiBgVHJ1ZWAiCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY2FzID0gIioqQW50aXNwYW0oQ0FTKSBCYW5uZWQgOioqIGBGYWxzZWAiCiAgICBlbHNlOgogICAgICAgIGNhcyA9ICIqKkFudGlzcGFtKENBUykgQmFubmVkIDoqKiBgQ291bGRuJ3QgRmV0Y2hgIgogICAgY2FwdGlvbiA9ICIiIioq2YXYudmE2YjZhdin2Kog2KfZhNmF2LPZgNiq2K7Yr9mFW3t9XSh0ZzovL3VzZXI/aWQ9e30pOgogICDijJTvuJnimpXvuI8g2KfZhNin2YrYr9mKOiAqKmB7fWAKICAg4oyU77iZ8J+RpSoq2KfZhNmF2KzZhdmI2LnYp9iqINin2YTZhdi02KrYsdmD2YcgOiAqKmB7fWAKICAg4oyU77iZ8J+Mjyoq2LHZgtmFINmC2KfYudiv2Ycg2KfZhNio2YrYp9mG2KfYqiA6ICoqYHt9YAogICDijJTvuJnwn5SPKirZh9mEINmH2Ygg2K3Ys9in2Kgg2YXZiNir2YIgIDogKipge31gCiIiIi5mb3JtYXQoCiAgICAgICAgZmlyc3RfbmFtZSwKICAgICAgICB1c2VyX2lkLAogICAgICAgIHVzZXJfaWQsCiAgICAgICAgY29tbW9uX2NoYXRzLAogICAgICAgIGRjX2lkLAogICAgICAgIHJlcGxpZWRfdXNlci51c2VyLnJlc3RyaWN0ZWQsCiAgICAgICAgc3csCiAgICAgICAgY2FzLAogICAgKQogICAgYXdhaXQgZWRpdF9vcl9yZXBseShjYXRldmVudCwgY2FwdGlvbikKCgpAam10aG9uLmFyX2NtZCgKICAgIHBhdHRlcm49Itin2YrYr9mKKD86XHN8JCkoW1xzXFNdKikiLAogICAgY29tbWFuZD0oItin2YrYr9mKIiwgcGx1Z2luX2NhdGVnb3J5KSwKICAgIGluZm89ewogICAgICAgICJoZWFkZXIiOiAiR2V0cyBpbmZvIG9mIGFuIHVzZXIuIiwKICAgICAgICAiZGVzY3JpcHRpb24iOiAiVXNlciBjb21wZWxldGUgZGV0YWlscy4iLAogICAgICAgICJ1c2FnZSI6ICJ7dHJ9d2hvaXMgPHVzZXJuYW1lL3VzZXJpZC9yZXBseT4iLAogICAgfSwKKQphc3luYyBkZWYgd2hvKGV2ZW50KToKICAgICJHZXRzIGluZm8gb2YgYW4gdXNlciIKICAgIGlmIG5vdCBvcy5wYXRoLmlzZGlyKENvbmZpZy5UTVBfRE9XTkxPQURfRElSRUNUT1JZKToKICAgICAgICBvcy5tYWtlZGlycyhDb25maWcuVE1QX0RPV05MT0FEX0RJUkVDVE9SWSkKICAgIHJlcGxpZWRfdXNlciwgcmVhc29uID0gYXdhaXQgZ2V0X3VzZXJfZnJvbV9ldmVudChldmVudCkKICAgIGlmIG5vdCByZXBsaWVkX3VzZXI6CiAgICAgICAgcmV0dXJuCiAgICBjYXQgPSBhd2FpdCBlZGl0X29yX3JlcGx5KGV2ZW50LCAiKirijK/vuJnZitiq2YUg2KfYs9iq2K7Ysdin2Kwg2YXYudmE2YjZhdin2Kog2KfZhNmF2LPYqtiu2K/ZhSAqKiIpCiAgICByZXBsaWVkX3VzZXIgPSBhd2FpdCBldmVudC5jbGllbnQoR2V0RnVsbFVzZXJSZXF1ZXN0KHJlcGxpZWRfdXNlci5pZCkpCiAgICB0cnk6CiAgICAgICAgcGhvdG8sIGNhcHRpb24gPSBhd2FpdCBmZXRjaF9pbmZvKHJlcGxpZWRfdXNlciwgZXZlbnQpCiAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgcmV0dXJuIGF3YWl0IGVkaXRfb3JfcmVwbHkoCiAgICAgICAgICAgIGNhdCwgIioq4oyv77iZ2YTZhSDZitiq2YUg2KfZhNi52KvZiNixINi52YTZiSDZhdi52YTZiNmF2KfYqiDZhNmH2LDYpyDYp9mE2YXYs9iq2K7Yr9mFICoqIgogICAgICAgICkKICAgIG1lc3NhZ2VfaWRfdG9fcmVwbHkgPSBhd2FpdCByZXBseV9pZChldmVudCkKICAgIHRyeToKICAgICAgICBhd2FpdCBldmVudC5jbGllbnQuc2VuZF9maWxlKAogICAgICAgICAgICBldmVudC5jaGF0X2lkLAogICAgICAgICAgICBwaG90bywKICAgICAgICAgICAgY2FwdGlvbj1jYXB0aW9uLAogICAgICAgICAgICBsaW5rX3ByZXZpZXc9RmFsc2UsCiAgICAgICAgICAgIGZvcmNlX2RvY3VtZW50PUZhbHNlLAogICAgICAgICAgICByZXBseV90bz1tZXNzYWdlX2lkX3RvX3JlcGx5LAogICAgICAgICAgICBwYXJzZV9tb2RlPSJodG1sIiwKICAgICAgICApCiAgICAgICAgaWYgbm90IHBob3RvLnN0YXJ0c3dpdGgoImh0dHAiKToKICAgICAgICAgICAgb3MucmVtb3ZlKHBob3RvKQogICAgICAgIGF3YWl0IGNhdC5kZWxldGUoKQogICAgZXhjZXB0IFR5cGVFcnJvcjoKICAgICAgICBhd2FpdCBjYXQuZWRpdChjYXB0aW9uLCBwYXJzZV9tb2RlPSJodG1sIikKCgojINmD2YDYqtin2KjYqSAgQFJSN1BQCiMg2KrYudiv2YrZhCDZiNiq2LHYqtmK2KggIEBTQkJfQgpAam10aG9uLmFyX2NtZCgKICAgIHBhdHRlcm49Itix2KfYqNi3INin2YTYrdiz2KfYqCg/OlxzfCQpKFtcc1xTXSopIiwKICAgIGNvbW1hbmQ9KCLYsdin2KjYtyDYp9mE2K3Ys9in2KgiLCBwbHVnaW5fY2F0ZWdvcnkpLAogICAgaW5mbz17CiAgICAgICAgImhlYWRlciI6ICJHZW5lcmF0ZXMgYSBsaW5rIHRvIHRoZSB1c2VyJ3MgUE0gLiIsCiAgICAgICAgInVzYWdlIjogInt0cn1saW5rIDx1c2VybmFtZS91c2VyaWQvcmVwbHk+IiwKICAgIH0sCikKYXN5bmMgZGVmIHBlcm1hbGluayhtZW50aW9uKToKICAgICIiIkdlbmVyYXRlcyBhIGxpbmsgdG8gdGhlIHVzZXIncyBQTSB3aXRoIGEgY3VzdG9tIHRleHQuIiIiCiAgICB1c2VyLCBjdXN0b20gPSBhd2FpdCBnZXRfdXNlcl9mcm9tX2V2ZW50KG1lbnRpb24pCiAgICBpZiBub3QgdXNlcjoKICAgICAgICByZXR1cm4KICAgIGlmIGN1c3RvbToKICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9vcl9yZXBseShtZW50aW9uLCBmIlt7Y3VzdG9tfV0odGc6Ly91c2VyP2lkPXt1c2VyLmlkfSkiKQogICAgdGFnID0gdXNlci5maXJzdF9uYW1lLnJlcGxhY2UoIlx1MjA2MCIsICIiKSBpZiB1c2VyLmZpcnN0X25hbWUgZWxzZSB1c2VyLnVzZXJuYW1lCiAgICBhd2FpdCBlZGl0X29yX3JlcGx5KG1lbnRpb24sIGYi4oyU77iZW3t0YWd9XSh0ZzovL3VzZXI/aWQ9e3VzZXIuaWR9KSIpCg=='))
