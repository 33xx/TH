import base64

exec(
    base64.b64decode(
        b"aW1wb3J0IHJlcXVlc3RzCmZyb20gdmFsaWRhdG9ycy51cmwgaW1wb3J0IHVybAoKZnJvbSB1c2VyYm90IGltcG9ydCBqbXRob24KCmZyb20gLi5jb3JlLm1hbmFnZXJzIGltcG9ydCBlZGl0X2RlbGV0ZSwgZWRpdF9vcl9yZXBseQoKcGx1Z2luX2NhdGVnb3J5ID0gInV0aWxzIgoKCkBqbXRob24uYXJfY21kKAogICAgcGF0dGVybj0i2K/ZhtizKD86XHN8JCkoW1xzXFNdKikiLAogICAgY29tbWFuZD0oItiv2YbYsyIsIHBsdWdpbl9jYXRlZ29yeSksCiAgICBpbmZvPXsKICAgICAgICAiaGVhZGVyIjogIlRvIGdldCBEb21haW4gTmFtZSBTeXN0ZW0oZG5zKSBvZiB0aGUgZ2l2ZW4gbGluay4iLAogICAgICAgICJ1c2FnZSI6ICJ7dHJ9ZG5zIDx1cmwvcmVwbHkgdG8gdXJsPiIsCiAgICAgICAgImV4YW1wbGVzIjogInt0cn1kbnMgZ29vZ2xlLmNvbSIsCiAgICB9LAopCmFzeW5jIGRlZiBfKGV2ZW50KToKICAgICJUbyBnZXQgRG9tYWluIE5hbWUgU3lzdGVtKGRucykgb2YgdGhlIGdpdmVuIGxpbmsuIgogICAgaW5wdXRfc3RyID0gIiIuam9pbihldmVudC50ZXh0LnNwbGl0KG1heHNwbGl0PTEpWzE6XSkKICAgIHJlcGx5ID0gYXdhaXQgZXZlbnQuZ2V0X3JlcGx5X21lc3NhZ2UoKQogICAgaWYgbm90IGlucHV0X3N0ciBhbmQgcmVwbHk6CiAgICAgICAgaW5wdXRfc3RyID0gcmVwbHkudGV4dAogICAgaWYgbm90IGlucHV0X3N0cjoKICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9kZWxldGUoCiAgICAgICAgICAgIGV2ZW50LCAi4pmw77iZINmK2KzZgNioINi52YTZitmFINin2YTYsdivINi52YTZiSDYp9mE2LHYp9io2Lcg2KfZiCDZiNi22Lkg2KfZhNix2KfYqNi3INmF2Lkg2KfZhNin2YUiLCA1CiAgICAgICAgKQogICAgY2hlY2sgPSB1cmwoaW5wdXRfc3RyKQogICAgaWYgbm90IGNoZWNrOgogICAgICAgIGNhdHN0ciA9ICJodHRwOi8vIiArIGlucHV0X3N0cgogICAgICAgIGNoZWNrID0gdXJsKGNhdHN0cikKICAgIGlmIG5vdCBjaGVjazoKICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9kZWxldGUoZXZlbnQsICLimbDvuJkg2YfYsNinINin2YTYsdin2KjYtyDYutmK2LEg2YXYr9i52YjZhSIsIDUpCiAgICBzYW1wbGVfdXJsID0gZiJodHRwczovL2RhLmdkL2Rucy97aW5wdXRfc3RyfSIKICAgIHJlc3BvbnNlX2FwaSA9IHJlcXVlc3RzLmdldChzYW1wbGVfdXJsKS50ZXh0CiAgICBpZiByZXNwb25zZV9hcGk6CiAgICAgICAgYXdhaXQgZWRpdF9vcl9yZXBseShldmVudCwgZiLYp9mE2YAg2K/ZiiDYo9mGINin2LMg2YTZgCB7aW5wdXRfc3RyfSDZh9mKIFxuXG57cmVzcG9uc2VfYXBpfSIpCiAgICBlbHNlOgogICAgICAgIGF3YWl0IGVkaXRfb3JfcmVwbHkoZXZlbnQsIGYi4pmw77iZLSDZhNmFINin2LPYqti32Lkg2KfZitis2KfYryBge2lucHV0X3N0cn1gINmB2Yog2KfZhNin2YbYqtix2YbYqiIpCgoKIyB1cmx0b29scyBmb3Igam10aG9uCkBqbXRob24uYXJfY21kKAogICAgcGF0dGVybj0i2YXYtdi62LEoPzpcc3wkKShbXHNcU10qKSIsCiAgICBjb21tYW5kPSgi2YXYtdi62LEiLCBwbHVnaW5fY2F0ZWdvcnkpLAogICAgaW5mbz17CiAgICAgICAgImhlYWRlciI6ICJUbyBzaG9ydCB0aGUgZ2l2ZW4gdXJsLiIsCiAgICAgICAgInVzYWdlIjogInt0cn1zaG9ydCA8dXJsL3JlcGx5IHRvIHVybD4iLAogICAgICAgICJleGFtcGxlcyI6ICJ7dHJ9c2hvcnQgaHR0cHM6Ly9naXRodWIuY29tL1JSN1BQMTcwOS9jYXR1c2VyYm90IiwKICAgIH0sCikKYXN5bmMgZGVmIF8oZXZlbnQpOgogICAgInNob3J0ZW5zIHRoZSBnaXZlbiBsaW5rIgogICAgaW5wdXRfc3RyID0gIiIuam9pbihldmVudC50ZXh0LnNwbGl0KG1heHNwbGl0PTEpWzE6XSkKICAgIHJlcGx5ID0gYXdhaXQgZXZlbnQuZ2V0X3JlcGx5X21lc3NhZ2UoKQogICAgaWYgbm90IGlucHV0X3N0ciBhbmQgcmVwbHk6CiAgICAgICAgaW5wdXRfc3RyID0gcmVwbHkudGV4dAogICAgaWYgbm90IGlucHV0X3N0cjoKICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9kZWxldGUoCiAgICAgICAgICAgIGV2ZW50LCAi4pmw77iZINmK2KzZgNioINi52YTZitmFINin2YTYsdivINi52YTZiSDYp9mE2LHYp9io2Lcg2KfZiCDZiNi22Lkg2KfZhNix2KfYqNi3INmF2Lkg2KfZhNin2YXYsSIsIDUKICAgICAgICApCiAgICBjaGVjayA9IHVybChpbnB1dF9zdHIpCiAgICBpZiBub3QgY2hlY2s6CiAgICAgICAgY2F0c3RyID0gZiJodHRwOi8vIiArIGlucHV0X3N0cgogICAgICAgIGNoZWNrID0gdXJsKGNhdHN0cikKICAgIGlmIG5vdCBjaGVjazoKICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9kZWxldGUoZXZlbnQsICLimbDvuJkg2YfYsNinINin2YTYsdin2KjYtyDYutmK2LEg2YXYr9i52YjZhSIsIDUpCiAgICBpZiBub3QgaW5wdXRfc3RyLnN0YXJ0c3dpdGgoImh0dHAiKToKICAgICAgICBpbnB1dF9zdHIgPSAiaHR0cDovLyIgKyBpbnB1dF9zdHIKICAgIHNhbXBsZV91cmwgPSBmImh0dHBzOi8vZGEuZ2Qvcz91cmw9e2lucHV0X3N0cn0iCiAgICByZXNwb25zZV9hcGkgPSByZXF1ZXN0cy5nZXQoc2FtcGxlX3VybCkudGV4dAogICAgaWYgcmVzcG9uc2VfYXBpOgogICAgICAgIGF3YWl0IGVkaXRfb3JfcmVwbHkoCiAgICAgICAgICAgIGV2ZW50LCBmIuKZsO+4mdiq2YDZhSDYtdmG2YDYuSDYsdin2KjZgNi3INmF2LXYutixOiB7cmVzcG9uc2VfYXBpfSIsIGxpbmtfcHJldmlldz1GYWxzZQogICAgICAgICkKICAgIGVsc2U6CiAgICAgICAgYXdhaXQgZWRpdF9vcl9yZXBseShldmVudCwgIuKZsO+4mSDZh9mA2YbYp9mE2YMg2LTZiiDYrti32YDYpyDYrdin2YjZhCDZhNin2K3ZgtmA2KciKQoKCiMgdXJsdG9vbHMgZm9yIGptdGhvbgoKCkBqbXRob24uYXJfY21kKAogICAgcGF0dGVybj0i2KfYrtmB2KfYoSg/OlxzfCQpKFtcc1xTXSopIiwKICAgIGNvbW1hbmQ9KCLYp9iu2YHYp9ihIiwgcGx1Z2luX2NhdGVnb3J5KSwKICAgIGluZm89ewogICAgICAgICJoZWFkZXIiOiAiVG8gaGlkZSB0aGUgdXJsIHdpdGggd2hpdGUgc3BhY2VzIHVzaW5nIGh5cGVybGluay4iLAogICAgICAgICJ1c2FnZSI6ICJ7dHJ9aGwgPHVybC9yZXBseSB0byB1cmw+IiwKICAgICAgICAiZXhhbXBsZXMiOiAie3RyfWhsIGh0dHBzOi8vZGEuZ2Qvcm02cXJpIiwKICAgIH0sCikKYXN5bmMgZGVmIF8oZXZlbnQpOgogICAgIlRvIGhpZGUgdGhlIHVybCB3aXRoIHdoaXRlIHNwYWNlcyB1c2luZyBoeXBlcmxpbmsuIgogICAgaW5wdXRfc3RyID0gIiIuam9pbihldmVudC50ZXh0LnNwbGl0KG1heHNwbGl0PTEpWzE6XSkKICAgIHJlcGx5ID0gYXdhaXQgZXZlbnQuZ2V0X3JlcGx5X21lc3NhZ2UoKQogICAgaWYgbm90IGlucHV0X3N0ciBhbmQgcmVwbHk6CiAgICAgICAgaW5wdXRfc3RyID0gcmVwbHkudGV4dAogICAgaWYgbm90IGlucHV0X3N0cjoKICAgICAgICByZXR1cm4gYXdhaXQgZWRpdF9kZWxldGUoCiAgICAgICAgICAgIGV2ZW50LCAi4pmw77iZINmK2KzZgNioINi52YTZitmFINin2YTYsdivINi52YTZiSDYp9mE2LHYp9io2Lcg2KfZiCDZiNi22Lkg2KfZhNix2KfYqNi3INmF2Lkg2KfZhNin2YXYsSIsIDUKICAgICAgICApCiAgICBjaGVjayA9IHVybChpbnB1dF9zdHIpCiAgICBpZiBub3QgY2hlY2s6CiAgICAgICAgY2F0c3RyID0gImh0dHA6Ly8iICsgaW5wdXRfc3RyCiAgICAgICAgY2hlY2sgPSB1cmwoY2F0c3RyKQogICAgaWYgbm90IGNoZWNrOgogICAgICAgIHJldHVybiBhd2FpdCBlZGl0X2RlbGV0ZShldmVudCwgIuKZsO+4mSDZh9iw2Kcg2KfZhNix2KfYqNi3INi62YrYsSDZhdiv2LnZiNmFIiwgNSkKICAgIGF3YWl0IGVkaXRfb3JfcmVwbHkoZXZlbnQsICJb44Wk44Wk44Wk44Wk44Wk44Wk44WkXSgiICsgaW5wdXRfc3RyICsgIikiKQo="
    )
)
